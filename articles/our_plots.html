<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SerolyzeR plots • SerolyzeR</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SerolyzeR plots">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SerolyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example_script.html">Basic SerolyzeR functionalities</a></li>
    <li><a class="dropdown-item" href="../articles/multiplate_tutorial.html">Multiplate SerolyzeR functionalities</a></li>
    <li><a class="dropdown-item" href="../articles/our_datasets.html">Our datasets</a></li>
    <li><a class="dropdown-item" href="../articles/our_plots.html">SerolyzeR plots</a></li>
    <li><a class="dropdown-item" href="../articles/our_reports.html">SerolyzeR HTML reports</a></li>
    <li><a class="dropdown-item" href="../articles/parsers.html">Raw data parsers</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mini-pw/SerolyzeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SerolyzeR plots</h1>
                        <h4 data-toc-skip class="author">Mateusz
Nizwantowski</h4>
            
            <h4 data-toc-skip class="date">2025-07-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mini-pw/SerolyzeR/blob/main/vignettes/our_plots.Rmd" class="external-link"><code>vignettes/our_plots.Rmd</code></a></small>
      <div class="d-none name"><code>our_plots.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>SerolyzeR</code> package provides a variety of plots that
can be used to visualize the Luminex data. In this vignette, we will
show how to use them. To present the package’s functionalities, we use a
sample dataset from the Covid OISE study, which is pre-loaded into the
package. Firstly, let us load the dataset as the <code>plate</code>
object.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mini-pw/SerolyzeR" class="external-link">SerolyzeR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plate_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"SerolyzeR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># get the filepath of the csv dataset</span></span>
<span></span>
<span><span class="va">layout_filepath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.xlsx"</span>, package <span class="op">=</span> <span class="st">"SerolyzeR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_filepath</span>, <span class="va">layout_filepath</span><span class="op">)</span> <span class="co"># read the data</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/CovidOISExPONTENT.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: CovidOISExPONTENT!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plate</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Plate with 96 samples and 30 analytes</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plate-layout">Plate layout<a class="anchor" aria-label="anchor" href="#plate-layout"></a>
</h2>
<p>We will omit some validation functionality in this vignette and focus
on the plots. After successfully loading the plate, we should validate
it by looking at some basic information using the summary function.
However, we can obtain similar information more visually using the
<code>plot_layout</code> function. It helps to quickly asses whether the
layout of the plate is correctly read from Luminex or the layout file.
The function takes the <code>plate</code> object as the argument.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_layout.html">plot_layout</a></span><span class="op">(</span><span class="va">plate</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-2-1.png" width="70%"></p>
<p>The plot above shows the layout of the plate. The wells are coloured
according to the type of sample. If the user is familiar with the colour
scheme of this package, there is an option to turn off the legend. This
can be done by setting the <code>show_legend</code> parameter to
<code>FALSE</code>.</p>
<p>If the plot window is resized, it is recommended that the function be
rerun to adjust the scaling of the plot. Sometimes, the whole layout may
be shifted when a legend is plotted. To solve this issue, one has to
stretch the window toward the layout shift, and everything will be
adjusted automatically.</p>
</div>
<div class="section level2">
<h2 id="counts-for-a-given-analyte">Counts for a given analyte<a class="anchor" aria-label="anchor" href="#counts-for-a-given-analyte"></a>
</h2>
<p>The <code>plot_counts</code> function allows us to visualize the
counts of the analyte in the plate. This plot is useful for quickly
spotting wells with a count that is too low to interpret results with
high confidence. The function takes the <code>plate</code> object and
the analyte name as the arguments. The function will return an error
message if there is a typo in the analyte name.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts.html">plot_counts</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-3-1.png" width="70%"></p>
<p>The plot above shows the the analyte “OC43_NP_NA” counts in the
plate. The wells are coloured according to the count of the analyte.
Too-low values are marked with red, values on the edge of the threshold
are marked with yellow, and the rest are marked with green. There is an
option to show legend by setting the <code>show_legend</code> parameter
to <code>TRUE</code>. There is also an option to show the colours
without the counts by setting the <code>show_counts</code> parameter to
<code>FALSE</code>. This provides a cleaner plot without the counts.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_counts.html">plot_counts</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"FluA"</span>, plot_counts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-4-1.png" width="70%"></p>
</div>
<div class="section level2">
<h2 id="distribution-of-mfi-values">Distribution of MFI values<a class="anchor" aria-label="anchor" href="#distribution-of-mfi-values"></a>
</h2>
<p>The <code>plot_mfi_distribution</code> function allows us to
visualize the distribution of the MFI values for test samples for the
given analyte. And how they compare to standard curve samples on a given
plate. This plot is helpful to asses if the standard curve samples cover
the whole range of MFI of test samples. The function takes the
<code>plate</code> object and the analyte name as the arguments. The
function will return an error message if there is a typo in the analyte
name.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-5-1.png" width="70%"></p>
<p>This plot shows the distribution of the MFI values for test samples
for the analyte “OC43_NP_NA”. The test samples are coloured in blue, and
the standard curve samples are coloured in red. The default plot type is
violin, but there is an option to change it to the boxplot by setting
the <code>plot_type</code> parameter to <code>boxplot</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"FluA"</span>, plot_type <span class="op">=</span> <span class="st">"boxplot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-6-1.png" width="70%"></p>
<p>Additionally, we can modify the scale of y-axis by setting the
<code>scale_y</code> to the desired transformation from ggplot2 package.
In case of <code>boxplot</code> type of plot, we may include the
outliers by the <code>plot_outliers</code> parameter.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mfi_for_analyte.html">plot_mfi_for_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"FluA"</span>, plot_type <span class="op">=</span> <span class="st">"boxplot"</span>, scale_y <span class="op">=</span> <span class="st">"identity"</span>, plot_outliers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-7-1.png" width="70%"></p>
</div>
<div class="section level2">
<h2 id="standard-curve-plots">Standard curve plots<a class="anchor" aria-label="anchor" href="#standard-curve-plots"></a>
</h2>
<p>Finally, we arrive at the most crucial visualization in our package -
the standard curve-related plots. Those plots help assess the quality of
the fit, which will be crucial to us in the next step of package
development. It comes in two flavors:
<code>plot_standard_curve_analyte</code> and
<code>plot_standard_curve_analyte_with_model</code>. The first does not
incorporate the model, while the second does.</p>
<div class="section level3">
<h3 id="standard-curve-plot-without-model">Standard curve plot without model<a class="anchor" aria-label="anchor" href="#standard-curve-plot-without-model"></a>
</h3>
<p>This plot should be used to assess the quality of the assay. If
anything goes wrong during the plate preparation, it should be visible
easily in this plot.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_analyte.html">plot_standard_curve_analyte</a></span><span class="op">(</span><span class="va">plate</span>, <span class="st">"Spike_B16172"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-8-1.png" width="70%"></p>
<p>Above, we see the default plot for the analyte “Spike_B16172”. We can
modify this plot by setting the parameters of the function. For example,
we can change the direction of the x-axis by setting
<code>decreasing_rau_order</code> parameter to <code>FALSE</code>. Other
parameters worth mentioning are <code>log_scale</code>, the default
value is <code>c("all")</code>, which means that both the x and y axes
are in the log scale. Other parameters worth mentioning are
<code>log_scale</code>, the default value of which is
<code>c("all")</code>, which means that both the x and y axes are on the
log scale. There is also an option to turn off some parts of the plot by
setting parameters <code>plot_line</code>, <code>plot_blank_mean</code>
and <code>plot_rau_bounds</code> to <code>FALSE</code>. The first
disables drawing the line between standard curve points, the second
turns off plotting the mean of blank samples, and the last disables
plotting the RAU value bounds.</p>
</div>
<div class="section level3">
<h3 id="standard-curve-plot-with-model">Standard curve plot with model<a class="anchor" aria-label="anchor" href="#standard-curve-plot-with-model"></a>
</h3>
<p>This visualization is similar to the previous one but also
incorporates the model. Thus, it carries more information at the cost of
being more complex and crowded.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_standard_curve_model_analyte.html">create_standard_curve_model_analyte</a></span><span class="op">(</span><span class="va">plate</span>, analyte_name <span class="op">=</span> <span class="st">"Spike_B16172"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_standard_curve_analyte_with_model.html">plot_standard_curve_analyte_with_model</a></span><span class="op">(</span><span class="va">plate</span>, <span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-9-1.png" width="70%"></p>
<p>Here, we do not have to specify the analyte name, as the model
already carries this information. The model is created by the
<code>create_standard_curve_model_analyte</code> function, which takes
the <code>plate</code> object and the analyte name as the arguments, but
this is not the focus of this vignette. The arguments of this function
are very similar to the previous one, except here there is a missing
<code>plot_line</code> argument, and there are two new arguments:
<code>plot_asymptote</code> and <code>plot_test_predictions</code>. The
first turns off the asymptotes, and the second disables plotting the
test samples’ predictions. By default, both are set to
<code>TRUE</code>.</p>
</div>
<div class="section level3">
<h3 id="standard-curve-plot-stacked">Standard curve plot stacked<a class="anchor" aria-label="anchor" href="#standard-curve-plot-stacked"></a>
</h3>
<p>As another quality control measure, that detects either plates with
inconsistent results or deterioration of calibration in time we can use
the <code>plot_standard_curve_stacked</code> function. This function
plots all standard curves on the same plot for a given analyte, which
allows us to compare them easily. In order to run this function, we need
to provide the <code>list_of_plates</code> which is a list of plate
objects and the analyte name as the arguments.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir_with_luminex_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"multiplate_tutorial"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"SerolyzeR"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"multiplate-tutorial"</span><span class="op">)</span> <span class="co"># create a temporary directory to store the output data</span></span>
<span><span class="fu">R.utils</span><span class="fu">::</span><span class="fu"><a href="https://henrikbengtsson.github.io/R.utils/reference/mkdirs.html" class="external-link">mkdirs</a></span><span class="op">(</span><span class="va">output_dir</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_of_plates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_dir.html">process_dir</a></span><span class="op">(</span><span class="va">dir_with_luminex_files</span>,</span>
<span>  return_plates <span class="op">=</span> <span class="cn">TRUE</span>, format <span class="op">=</span> <span class="st">"xPONENT"</span>, output_dir <span class="op">=</span> <span class="va">output_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P10_SEROPED_62PLEX_PLATE10_04062023_RUN004.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P10_SEROPED_62PLEX_PLATE10_04062023_RUN004!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P10_SEROPED_62PLEX_PLATE10_04062023_RUN004'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P11_SEROPED_62PLEX_PLATE11_04062023_RUN005.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P11_SEROPED_62PLEX_PLATE11_04062023_RUN005!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P11_SEROPED_62PLEX_PLATE11_04062023_RUN005'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P12_SEROPED_62PLEX_PLATE12_04072023_RUN000.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P12_SEROPED_62PLEX_PLATE12_04072023_RUN000!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P12_SEROPED_62PLEX_PLATE12_04072023_RUN000'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P13_SEROPED_62PLEX_PLATE13_04072023_RUN001.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P13_SEROPED_62PLEX_PLATE13_04072023_RUN001!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P13_SEROPED_62PLEX_PLATE13_04072023_RUN001'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P14_SEROPED_62PLEX_PLATE14_04072023_RUN002.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P14_SEROPED_62PLEX_PLATE14_04072023_RUN002!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P14_SEROPED_62PLEX_PLATE14_04072023_RUN002'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P1_SEROPED_PBT_62PLEX_PLATE1_03312023_RUN001.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P1_SEROPED_PBT_62PLEX_PLATE1_03312023_RUN001!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P1_SEROPED_PBT_62PLEX_PLATE1_03312023_RUN001'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P2_SEROPED_62PLEX_PLATE2_04042023_RUN000.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P2_SEROPED_62PLEX_PLATE2_04042023_RUN000!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P2_SEROPED_62PLEX_PLATE2_04042023_RUN000'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P3_rerun_SEROPED_PLATE3_04042023_RUN002.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P3_rerun_SEROPED_PLATE3_04042023_RUN002!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P3_rerun_SEROPED_PLATE3_04042023_RUN002'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P4_SEROPED_62PLEX_PLATE4_04042023_RUN003.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P4_SEROPED_62PLEX_PLATE4_04042023_RUN003!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P4_SEROPED_62PLEX_PLATE4_04042023_RUN003'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P5_SEROPED_62PLEX_PLATE5_04052023_RUN001.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P5_SEROPED_62PLEX_PLATE5_04052023_RUN001!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P5_SEROPED_62PLEX_PLATE5_04052023_RUN001'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P6_SEROPED_62PLEX_PLATE6_04052023_RUN003.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P6_SEROPED_62PLEX_PLATE6_04052023_RUN003!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P6_SEROPED_62PLEX_PLATE6_04052023_RUN003'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P7_SEROPED_62PLEX_PLATE7_04052023_RUN004.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P7_SEROPED_62PLEX_PLATE7_04052023_RUN004!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P7_SEROPED_62PLEX_PLATE7_04052023_RUN004'</span></span>
<span><span class="co">#&gt; Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/multiplate_tutorial/P8_SEROPED_62PLEX_PLATE8_04052023_RUN005.csv</span></span>
<span><span class="co">#&gt; using format xPONENT</span></span></code></pre>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; New plate object has been created with name: P8_SEROPED_62PLEX_PLATE8_04052023_RUN005!</span></span></span>
<span><span class="co"><span style="color: #00BB00;">#&gt; </span></span></span>
<span><span class="co">#&gt; Processing plate 'P8_SEROPED_62PLEX_PLATE8_04052023_RUN005'</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Extracting the raw MFI to the output dataframe</span></span>
<span><span class="co">#&gt; Merged output saved to: /tmp/RtmpnApdn1/multiplate-tutorial/merged_MFI_20250718_175804.csv</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span>
<span><span class="co">#&gt; Fitting the models and predicting RAU for each analyte</span></span></code></pre>
<pre><code><span><span class="co">#&gt; Merged output saved to: /tmp/RtmpnApdn1/multiplate-tutorial/merged_RAU_20250718_175804.csv</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Computing nMFI values for each analyte</span></span>
<span><span class="co">#&gt; Merged output saved to: /tmp/RtmpnApdn1/multiplate-tutorial/merged_nMFI_20250718_175804.csv</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_stacked.html">plot_standard_curve_stacked</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-10-1.png" width="70%"></p>
<p>While we can pass to this function parameters found in other standard
curve plots, like <code>log_scale</code>,
<code>decreasing_rau_order</code>, <code>data_type</code> there is one
additional parameter that we want to focus on. Parameter is called
<code>monochromatic</code> and its default value is <code>TRUE</code>.
This results in a plots with a different shades of blue for each plate.
The more recent plates are darker while the older ones are almost white.
This helps quickly visualize drift in calibration of the equipment over
time.</p>
<p>When the <code>monochromatic</code> parameter is set to
<code>FALSE</code>, there is more variety in the colours of the plates,
which can be useful when comparing many plates. Each plate is more
distinct from the others, which can be helpful when looking for
outliers.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_stacked.html">plot_standard_curve_stacked</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span>, monochromatic <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-11-1.png" width="70%"></p>
<p>There are a few more useful parameters in this function—mainly
<code>legend_type</code>. By default it is set to <code>NULL</code>,
which means that the legend type is determined based on the
<code>monochromatic</code> value. If <code>monochromatic</code> is equal
to <code>TRUE</code>, then the legend type is set to <code>date</code>;
if it is <code>FALSE</code>, then the legend type is set to
<code>plate_name</code>. The user can override this behavior by
explicitly setting <code>legend_type</code> to <code>date</code> or
<code>plate_name</code>.</p>
<p>Additionally, if an user wants to play around with the legend
position, a parameter <code>legend_position</code> is here to help. It
simply specifies where the legend should be positioned - at the bottom,
top, left or right of the plot. By default it is set to
<code>bottom</code>.</p>
<p>There might occur a situation, where the plate names are really long,
and simply do not fit in the legend box. For such situations, we have
prepared <code>max_legend_items_per_row</code> and
<code>legend_text_size</code> parameters. The first one automatically
decides how many legend elements should be placed in one row of the
legend. By default it is set to <code>3</code>. The second parameter
sets the font size in the legend.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_standard_curve_stacked.html">plot_standard_curve_stacked</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span>, monochromatic <span class="op">=</span> <span class="cn">FALSE</span>, legend_position <span class="op">=</span> <span class="st">"top"</span>, max_legend_items_per_row <span class="op">=</span> <span class="fl">3</span>, legend_text_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-12-1.png" width="70%"></p>
<p>To play around the additional theme settings of the plots produced by
any of the methods, you can also use the base <code>ggplot2</code>
methods. To do so, all you need to do is modify the <code>ggplot2</code>
object. Here, we will add a horizontal line, which could highlight some
threshold and also modify the title a bit.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_standard_curve_stacked.html">plot_standard_curve_stacked</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span>, monochromatic <span class="op">=</span> <span class="cn">FALSE</span>, legend_position <span class="op">=</span> <span class="st">"bottom"</span>, max_legend_items_per_row <span class="op">=</span> <span class="fl">3</span>, legend_text_size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1000</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"A custom title for this amazing plot"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">25000</span>, y <span class="op">=</span> <span class="fl">1000</span>, label <span class="op">=</span> <span class="st">"Threshold = 1000"</span>, color <span class="op">=</span> <span class="st">"red"</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-13-1.png" width="70%"></p>
</div>
</div>
<div class="section level2">
<h2 id="levey-jennings-plot">Levey-Jennings plot<a class="anchor" aria-label="anchor" href="#levey-jennings-plot"></a>
</h2>
<p>The <code>plot_levey_jennings</code> function allows us to visualize
the Levey-Jennings plot for the given analyte. This plot is useful for
spotting trends in the data, such as shifts or drifts in the data. The
function takes the <code>list_of_plates</code> and the
<code>analyte_name</code> as the mandatory arguments. The
<code>list_of_plates</code> can be obtained by the
<code>process_dir</code> function, which reads the plates from the
directory, it is recommended way or creating list of plates.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_levey_jennings.html">plot_levey_jennings</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span>, dilution <span class="op">=</span> <span class="st">"1/100"</span>, sd_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-14-1.png" width="70%"></p>
<p>The plot above shows the Levey-Jennings plot for the analyte “ME”
with the samples with <code>dilution</code> “1/100”. The default value
of <code>dilution</code> is “1/400”. The <code>sd_lines</code> parameter
allows us to set the distance of horizontal lines from the mean. For
example, <code>sd_lines = c(1, 2)</code> will plot four lines at
±1<em>SD and ± 2</em>SD, where SD is the standard deviation of the data.
The default value of the <code>sd_lines</code> parameter is
<code>c(1.96)</code>, which corresponds to approximately the 95%
confidence interval under a normal distribution. This means two
horizontal lines are drawn at ±1.96 times the standard deviation from
the mean, highlighting the typical range of expected variation. Values
falling outside these lines may indicate outliers or points requiring
further investigation.</p>
<p>The Levey-Jennings plot has some additional parameters that can
improve the readibility. For instance, we can replace the x-label with
actual plate names, or dates of examination - using a
<code>plate_labels</code> parameter. This can create very congested
labels, so to overcome this issue, the xlabels can be rotated with
<code>label_angle</code> parameter. Legend can be also positioned in
different places with <code>legend_position</code> parameter.</p>
<p>To make the plot analysis easier, it is zoomed out by a factor 1.5 in
y-axis.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_levey_jennings.html">plot_levey_jennings</a></span><span class="op">(</span><span class="va">list_of_plates</span>, <span class="st">"Adenovirus.T3"</span>, dilution <span class="op">=</span> <span class="st">"1/100"</span>, sd_lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, plate_labels <span class="op">=</span> <span class="st">"name"</span>, label_angle <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="our_plots_files/figure-html/unnamed-chunk-15-1.png" width="70%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tymoteusz Kwiecinski, Jakub Grzywaczewski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
