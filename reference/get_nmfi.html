<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Normalised MFI (nMFI) Values for a Plate — get_nmfi • SerolyzeR</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Normalised MFI (nMFI) Values for a Plate — get_nmfi"><meta name="description" content="Calculates normalised MFI (nMFI) values for each analyte in a Luminex plate.
The nMFI values are computed as the ratio of each test sample's MFI to the
MFI of a standard curve sample at a specified reference dilution."><meta property="og:description" content="Calculates normalised MFI (nMFI) values for each analyte in a Luminex plate.
The nMFI values are computed as the ratio of each test sample's MFI to the
MFI of a standard curve sample at a specified reference dilution."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SerolyzeR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example_script.html">Basic SerolyzeR functionalities</a></li>
    <li><a class="dropdown-item" href="../articles/multiplate_tutorial.html">Multiplate SerolyzeR functionalities</a></li>
    <li><a class="dropdown-item" href="../articles/our_datasets.html">Our datasets</a></li>
    <li><a class="dropdown-item" href="../articles/our_plots.html">SerolyzeR plots</a></li>
    <li><a class="dropdown-item" href="../articles/our_reports.html">SerolyzeR HTML reports</a></li>
    <li><a class="dropdown-item" href="../articles/parsers.html">Raw data parsers</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mini-pw/SerolyzeR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Normalised MFI (nMFI) Values for a Plate</h1>
      <small class="dont-index">Source: <a href="https://github.com/mini-pw/SerolyzeR/blob/main/R/get-nmfi.R" class="external-link"><code>R/get-nmfi.R</code></a></small>
      <div class="d-none name"><code>get_nmfi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates normalised MFI (nMFI) values for each analyte in a Luminex plate.
The nMFI values are computed as the ratio of each test sample's MFI to the
MFI of a standard curve sample at a specified reference dilution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_nmfi</span><span class="op">(</span></span>
<span>  <span class="va">plate</span>,</span>
<span>  reference_dilution <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">400</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"Median"</span>,</span>
<span>  sample_type_filter <span class="op">=</span> <span class="st">"ALL"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plate">plate<a class="anchor" aria-label="anchor" href="#arg-plate"></a></dt>
<dd><p>(<code><a href="Plate.html">Plate()</a></code>) a plate object for which to calculate the nMFI values</p></dd>


<dt id="arg-reference-dilution">reference_dilution<a class="anchor" aria-label="anchor" href="#arg-reference-dilution"></a></dt>
<dd><p>(<code>numeric(1) or character(1)</code>) the dilution value of the standard curve sample
to use as a reference for normalisation. The default is <code>1/400</code>.
It should refer to a dilution of a standard curve sample in the given plate object.
This parameter could be either a numeric value or a string.
In case it is a character string, it should have format <code>1/d+</code>, where <code>d+</code> is any positive integer.</p></dd>


<dt id="arg-data-type">data_type<a class="anchor" aria-label="anchor" href="#arg-data-type"></a></dt>
<dd><p>(<code>character(1)</code>) type of data for the computation. Median is the default</p></dd>


<dt id="arg-sample-type-filter">sample_type_filter<a class="anchor" aria-label="anchor" href="#arg-sample-type-filter"></a></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>) The types of samples to normalise.
(e.g., <code>"TEST"</code>, <code>"STANDARD CURVE"</code>). It can also be a vector of sample types.
In that case, dataframe with multiple sample types will be returned.
The default value is <code>"ALL"</code>, which corresponds to returning all the samples.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>(<code>logical(1)</code>) print additional information. The default is <code>TRUE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>nmfi (<code>data.frame</code>) a data frame with normalised MFI values for each analyte in the plate and all test samples.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Normalised MFI (nMFI) is a simple, model-free metric used to compare test
sample responses relative to a fixed concentration from the standard curve.
It is particularly useful when model fitting (e.g., for RAU calculation)
is unreliable or not possible, such as when test sample intensities fall
outside the standard curve range.</p>
<p>The function locates standard samples with the specified dilution and divides
each test sample’s MFI by the corresponding standard MFI value for each analyte.</p>
    </div>
    <div class="section level2">
    <h2 id="when-should-nmfi-be-used-">When Should nMFI Be Used?<a class="anchor" aria-label="anchor" href="#when-should-nmfi-be-used-"></a></h2>


<p>While RAU values are generally preferred for antibody quantification,
they require successful model fitting of the standard curve.
This may not be feasible when:</p><ul><li><p>The test samples produce MFI values outside the range of the standard curve.</p></li>
<li><p>The standard curve is poorly shaped or missing critical points.</p></li>
</ul><p>In such cases, nMFI serves as a useful alternative, allowing for
plate-to-plate comparison without the need for extrapolation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>L. Y. Chan, E. K. Yim, and A. B. Choo, Normalized median fluorescence: An alternative flow cytometry analysis method for tracking human embryonic stem cell states during differentiation,  http://dx.doi.org/10.1089/ten.tec.2012.0150</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read the plate</span></span></span>
<span class="r-in"><span><span class="va">plate_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT.csv"</span>, package <span class="op">=</span> <span class="st">"SerolyzeR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">layout_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CovidOISExPONTENT_layout.csv"</span>, package <span class="op">=</span> <span class="st">"SerolyzeR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">plate</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_luminex_data.html">read_luminex_data</a></span><span class="op">(</span><span class="va">plate_file</span>, <span class="va">layout_file</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reading Luminex data from: /home/runner/work/_temp/Library/SerolyzeR/extdata/CovidOISExPONTENT.csv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> using format xPONENT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Failed to extract from BatchMetadata: BatchStartTime not found in BatchMetadata.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> BatchStartTime successfully extracted from the header.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Could not parse datetime string using default datetime format. Trying other possibilies.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Successfully parsed datetime string using order: mdY IMS p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">New plate object has been created with name: CovidOISExPONTENT!</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># artificially bump up the MFI values of the test samples (the Median data type is default one)</span></span></span>
<span class="r-in"><span><span class="va">plate</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"Median"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">plate</span><span class="op">$</span><span class="va">sample_types</span> <span class="op">==</span> <span class="st">"TEST"</span>, <span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">plate</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="st">"Median"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">plate</span><span class="op">$</span><span class="va">sample_types</span> <span class="op">==</span> <span class="st">"TEST"</span>, <span class="op">]</span> <span class="op">*</span> <span class="fl">10</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate the nMFI values</span></span></span>
<span class="r-in"><span><span class="va">nmfi</span> <span class="op">&lt;-</span> <span class="fu">get_nmfi</span><span class="op">(</span><span class="va">plate</span>, reference_dilution <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">400</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we don't do any extrapolation and the values should be comparable across plates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nmfi</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Spike_6P        ME     HKU1_S    OC43_NP     OC43_S   HKU1_NP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0.006735897 0.1466667 0.03318584 0.03409836 0.06314244 0.0534070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/50  4.001122649 5.6133333 5.61172566 6.11081967 6.15712188 4.9456722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/100 2.436289644 2.7000000 2.72953540 2.79934426 2.91042584 2.5681400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/200 1.824586023 1.8777778 1.83849558 1.82557377 1.92070485 1.7615101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/400 1.000000000 1.0000000 1.00000000 1.00000000 1.00000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/800 0.586444008 0.5911111 0.53539823 0.52065574 0.53671072 0.5893186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         X229E_NP  Mumps_NP RBD_B16171    NL63_NP RBD_B16172  RBD_wuhan</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0.06293706 0.3855932  0.1034483 0.01903736 0.04207574 0.02611534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/50  3.30244755 6.2415254  8.0129310 2.98347701 7.08835905 4.80304679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/100 1.92482517 2.9067797  3.7198276 1.83477011 3.66339411 2.63039536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/200 1.64073427 1.7966102  2.1896552 1.47377874 2.15427770 1.73812115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/400 1.00000000 1.0000000  1.0000000 1.00000000 1.00000000 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/800 0.64335664 0.6822034  0.5323276 0.60488506 0.53436185 0.54406964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          NL63_S    X229E_S Spike_B16172 Spike_B117 Measles_NP       Ade5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0.1410788 0.05323194    0.0151749  0.0113899  0.1103896 0.00410497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/50  6.0622407 6.22370089    4.7903807  4.0802245  6.0779221 2.82473244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/100 2.9336100 2.81115336    2.7214506  2.4749092  3.1298701 1.85207448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/200 1.8568465 1.89860583    1.8137860  1.8420271  2.0259740 1.48116112</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/400 1.0000000 1.00000000    1.0000000  1.0000000  1.0000000 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/800 0.5850622 0.52598226    0.5951646  0.5965665  0.5887446 0.61618531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                NP   Spike_P1        Rub      Ade40  RBD_B117 Spike_B1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0.005941664 0.01177918 0.04894707 0.03777545 0.1025641  0.01491146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/50  3.291321570 4.52953586 4.75128059 5.62224554 6.7965812  4.33783784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/100 2.058786460 2.57383966 2.41605009 2.62644281 3.3623932  2.50093197</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/200 1.558156284 1.93284107 1.77120091 1.80640084 2.0871795  1.90866729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/400 1.000000000 1.00000000 1.00000000 1.00000000 1.0000000  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/800 0.520885848 0.58368495 0.59817871 0.53725079 0.5777778  0.60764212</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             FluA RBD_B1351    RBD_P15         S2 Spike_omicron RBD_omicron</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B     0.02048417 0.1785714 0.09322034 0.04310345    0.07150153   0.1886792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/50  6.31191806 7.5071429 6.93220339 4.63721264    5.65679265   1.4150943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/100 2.93389199 3.1357143 3.34322034 2.67385057    2.96935649   1.6509434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/200 1.95903166 1.9857143 1.94067797 1.78017241    1.99795710   1.5094340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/400 1.00000000 1.0000000 1.00000000 1.00000000    1.00000000   1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1/800 0.51769088 0.5857143 0.47881356 0.46767241    0.54954035   0.5377358</span>
<span class="r-in"><span><span class="co"># different params</span></span></span>
<span class="r-in"><span><span class="va">nmfi</span> <span class="op">&lt;-</span> <span class="fu">get_nmfi</span><span class="op">(</span><span class="va">plate</span>, reference_dilution <span class="op">=</span> <span class="st">"1/50"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nmfi</span> <span class="op">&lt;-</span> <span class="fu">get_nmfi</span><span class="op">(</span><span class="va">plate</span>, reference_dilution <span class="op">=</span> <span class="st">"1/50"</span>, sample_type_filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEST"</span>, <span class="st">"BLANK"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jakub Grzywaczewski, Tymoteusz Kwiecinski, Mateusz Nizwantowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

